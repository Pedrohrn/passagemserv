<div class="" sc-modal="perfilCtrl.modal">

  <div class="sc-modal-header">
		<i class="sc-modal-close sc-cursor-pointer sc-icon-fechar-1 sc-badge-hover-red" ng-click="perfilCtrl.close()"></i>
		<button class="sc-btn sc-btn-green sc-btn-thin sc-m-l-xxl" ng-click="perfilCtrl.novoPerfil()" type="button">Novo Perfil</button>
  </div>

  <div class="sc-modal-body" ng-if="perfilCtrl.perfilNovo">
    <div>
      <div class="sc-panel-body sc-m-b-md">
        <form>
          <div class="sc-fieldset flex-row" style="margin-top: 0 !important;">
            <div class="col-xs-auto col-md-5 col-sm-5">
              <div class="sc-label">Título do Perfil</div>
              <input class="sc-input-default sc-input-block"  ng-model="perfilCtrl.new_perfil" type="text">
            </div>
            <div class="col-xs-auto col-md-6 col-lg-4">
              <div class="sc-label">Permissões dos porteiros</div>
              <span class="sc-m-l-md sc-dropdown" sc-dropdown-menu>
                <button class="sc-btn sc-btn-blue sc-btn-thin sc-m-v-xs" ng-click="perfilCtrl.permissoesMenuToggle()" style="min-width: 8em;" type="button">
                  <div class="flex justify-content-space-between">
                    Permissões
                    <span class="sc-text-sm">
                      <i class="sc-icon-seta-5-cima"></i>
                    </span>
                  </div>
                  <span class="sc-badge sc-badge-fixed sc-bg-yellow"></span>
                </button>
                <ul class="sc-dropdown-menu ng-animation-slider sc-scrollbar" ng-if="perfilCtrl.permissoesMenu" style="max-height: 18em; overflow: auto; width: 100%; display: block;">
                  <li ng-repeat="permissao as permissao.label in perfilCtrl.permissoes track by permissao.id" ng-click="perfilCtrl.setPermissao(permissao)">
                    <div>
                      <i ng-class="{'sc-icon-quadrado-1': !permissao.checked ; 'sc-icon-visto-3': permissao.checked" class=""></i>
                      <span>{{permissao.label}}</span>
                    </div>
                  </li>
                </ul>
              </span>
            </div>
          </div>
          <div class="clear"></div>
          <div class="sc-fieldset">
            <div class="sc-p-l-xl sc-p-md">
              <span class="sc-label sc-text-xl sc-text-xxl-md sc-text-xl-xs">Objetos</span>
              <button ng-click="perfilCtrl.addCategoria()" class="sc-btn sc-btn-green sc-btn-sm sc-btn-thin sc-m-l-lg" type="button">Adicionar Categoria</button>
            </div>

            <div class="sc-fieldset sc-m-h-md sc-text-sm-xs" ng-repeat="categoria in perfilCtrl.listObjetos">
              <div class="sc-fieldset-head flex-row justify-items-center">
                <div class="sc-text-sm">
                  <div class="ng-show" ng-hide="categoriasCtrl.novaCategoria">
                    <label class="sc-input-group">
                      <select class="sc-input-default sc-input-block" ng-options="cat as cat.label disable when cat.disabled for cat in categoriasCtrl.list track by cat.id" ng-model="categoria.categoria">
                        <option value="">Selecione ou cadastre</option>
                      </select>
                      <button class="sc-btn sc-btn-default" ng-click="categoriasCtrl.showOptions(categoria)">
                        <span>
                          <i class="sc-icon sc-icon-reticiencias-v"></i>
                        </span>
                        <span sc-dropdown-menu class="sc-dropdown pull-right " ng-if="categoria.showOpts">
                          <ul class="sc-dropdown-menu ng-animation-slider" style="display: block; top: 2.3em;">
                            <li ng-click="categoriasCtrl.new()">
                              <div>Nova categoria</div>
                            </li>
                            <li ng-click="categoriasCtrl.edit($index)">
                              <div>Editar</div>
                            </li>
                            <li ng-click="categoriasCtrl.disable()">
                              <div>Desativar</div>
                            </li>
                            <li ng-click="categoriasCtrl.rmv($index)">
                              <div>Excluir</div>
                            </li>
                          </ul>
                        </span>
                      </button>
                    </label>
                  </div>
                  <div class="" ng-if="categoriasCtrl.novaCategoria">
                    <label class="sc-input-group">
                      <input class="sc-input-default sc-input-block" ng-model="categoriasCtrl.newCategoria" type="text">
                      <button class="sc-btn sc-btn-green" ng-click="categoriasCtrl.add()">
                        <i class="sc-icon sc-icon-mais-1"></i>
                      </button>
                      <button class="sc-btn sc-btn-red" ng-click="categoriasCtrl.new()">
                        <i class="sc-icon sc-icon-fechar-1"></i>
                      </button>
                    </label>
                  </div>
                </div>

                <div class="sc-m-l-md">
                  <i class="sc-icon sc-icon-mais-1 sc-badge-hover-green" ng-click="perfilCtrl.cadastrarItem(categoria)"></i>
                </div>
                <div class="sc-m-l-md">
                  <i class="sc-icon sc-icon-lixeira-2 sc-badge-hover-red" ng-click="perfilCtrl.removerCategoria($index)"></i>
                </div>
              </div>

              <div class="sc-p-t-xs">
                <ul>
                  <li class="" ng-if="categoria.itens.length > 0">
                    <div class="flex-row sc-p-v-md sc-label sc-text-blue">
                      <div class="col-xs-3 col-md-1 col-sm-2 sc-text-medium sc-label">Qtde</div>
                      <div class="sc-p-l-md col-xs-auto sc-text-medium sc-label">Item</div>
                    </div>
                  </li>
                  <li ng-repeat="item in categoria.itens" class="sc-p-b-sm">
                    <div class="flex-row">
                      <div class="col-xs-3 col-md-1 col-sm-2">
                        <input class="fcol-md-90 sc-input-default sc-input-thin" ng-value="item.qtd" ng-model="item.qtd" type="number" min="0" max="999" style="max-width: 4.1em;">
                      </div>
                      <div class="sc-p-l-md fcol-xs-auto">
                        <input class="fcol-xs-60 sc-input-default sc-input-thin col-xs-6" type="text" value="{{item.nome}}" ng-model="item.nome">
                      </div>
                      <div class="fcol-xs-1 align-right">
                        <i class="sc-icon sc-icon-lixeira-1 sc-badge-hover-red" ng-click="perfilCtrl.deleteItem(categoria, $index)"></i>
                      </div>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="align-right">
            <button class="sc-btn sc-btn-blue" ng-click="perfilCtrl.salvarPerfil()">Salvar</button>
            <button class="sc-btn sc-btn-red" ng-click="perfilCtrl.novoPerfil()">Cancelar</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div> <!-- tela de edição de perfis -->
    <div class="" ng-if="perfilCtrl.list.length == 0">
      <div class="sc-p-xxxl sc-text-gray sc-text-xl align-center" style="border-bottom: none;">Nenhum perfil foi cadastrado ainda!</div>
    </div>
    <div>
      <ul class="sc-accordion">
        <li class="" ng-repeat="perfil in perfilCtrl.list" ng-init="perfilCtrl.init(perfil)">
          <div class="sc-accordion-head flex-row" style="background-color: white;">
            <div class="fcol-xs-auto sc-m-l-lg">
              <div class="sc-ellipsis-inline sc-text-bold sc-text-black">{{perfil.perfil}}</div>
              <div class="sc-btn sc-btn-yellow sc-btn-sm sc-btn-thin sc-m-l-lg" ng-if="perfil.disabled">Desativado!</div>
            </div>
            <div class="fcol-xs-3em" sc-stop-click>
              <div class="sc-dropdown" ng-click="perfil.menu.toggle()">
                <i class="sc-badge-hover-gray sc-icon-reticiencias-v" ng-class="{'sc-badge-active': perfil.menu.opened}"></i>
                <ul class="sc-dropdown-menu ng-animation-slider pull-right ng-hide" ng-show="perfil.menu.opened" style="display: block;">
                  <li ng-click="perfil.edit.toggle()">
                    <span>Editar</span>
                  </li>
                  <li ng-click="perfilCtrl.duplicate(perfil)">
                    <span>Duplicar perfil</span>
                  </li>
                  <li ng-click="perfilCtrl.disable_enable(perfil)">
                    <span ng-if="!perfil.disabled">Desativar perfil</span>
                    <span ng-if="perfil.disabled">Ativar Perfil</span>
                  </li>
                  <li ng-click="perfilCtrl.rmv(perfil)">
                    <span>Excluir</span>
                  </li>
                  <li ng-click="perfilCtrl.showLog()">
                    <span>Histórico</span>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="sc-accordion-body" ng-if="perfil.edit.opened">
            <form class="sc-m-h-md">
              <div class="sc-p-t-lg">
                <div class="sc-fieldset flex-row" style="margin-top: 0 !important;">
                  <div class="col-xs-auto col-md-5 col-sm-5">
                    <div class="sc-label">Título do Perfil</div>
                    <input class="sc-input-default sc-input-block"  value="{{perfil.perfil}}" type="text">
                  </div>
                  <div class="align-self-center sc-p-t-xxxl col-xs-auto col-md-6 col-lg-4">
                    <div class="sc-m-l-md sc-dropdown" sc-dropdown-menu>
                      <button class="sc-btn sc-btn-blue sc-btn-thin sc-m-v-xs" ng-click="perfilCtrl.permissoesMenuToggle(perfil)" style="min-width: 8em;" type="button">
                        <div class="flex justify-content-space-between">
                          Permissões dos porteiros
                          <span class="sc-text-sm sc-p-l-md">
                            <i ng-class="{'sc-icon-seta-5-cima': perfil.permissoesMenu, 'sc-icon-seta-5-baixo': !perfil.permissoesMenu}"></i>
                          </span>
                        </div>
                        <span class="sc-badge sc-badge-fixed sc-bg-yellow">{{perfil.total_permissoes/perfil.permissoes.length}}</span>
                      </button>
                      <ul class="sc-dropdown-menu ng-animation-slider sc-scrollbar" ng-if="perfil.permissoesMenu" style="max-height: 18em; overflow: auto; display: block;">
                        <li ng-repeat="permissao in perfil.permissoes track by permissao.id" ng-click="perfilCtrl.setPermissao(perfil, permissoes, permissao)">
                          <div>
                            <i ng-class="{'sc-icon-quadrado-1': !permissao.checked , 'sc-icon-visto-3': permissao.checked}" class=""></i>
                            <span>{{permissao.label}}</span>
                          </div>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
              <div class="clear"></div>
              <div class="sc-fieldset">
                <div class="sc-p-l-xl sc-p-md">
                  <span class="sc-label sc-text-xl sc-text-xxl-md sc-text-xl-xs">Objetos</span>
                  <button ng-click="perfilCtrl.addCategoria()" class="sc-btn sc-btn-green sc-btn-sm sc-btn-thin sc-m-l-lg" type="button">Adicionar Categoria</button>
                </div>
                <div class="sc-fieldset sc-m-h-md sc-text-sm-xs" ng-repeat="categoria in perfilCtrl.listObjetos">
                  <div class="sc-fieldset-head flex-row justify-items-center">
                    <div class="sc-text-sm">
                      <div class="ng-show" ng-hide="categoriasCtrl.novaCategoria">
                        <label class="sc-input-group">
                          <select class="sc-input-default sc-input-block" ng-options="cat as cat.label disable when cat.disabled for cat in categoriasCtrl.list track by cat.id" ng-model="categoria.categoria">
                            <option value="">Selecione ou cadastre</option>
                          </select>
                          <button class="sc-btn sc-btn-default" ng-click="categoriasCtrl.showOptions(categoria)">
                            <span>
                              <i class="sc-icon sc-icon-reticiencias-v"></i>
                            </span>
                            <span sc-dropdown-menu class="sc-dropdown pull-right" ng-if="categoria.showOpts">
                              <ul class="sc-dropdown-menu ng-animation-slider" style="display: block; top: 2.3em;">
                                <li ng-click="categoriasCtrl.new()">
                                  <div>Nova categoria</div>
                                </li>
                                <li ng-click="categoriasCtrl.edit($index)">
                                  <div>Editar</div>
                                </li>
                                <li ng-click="categoriasCtrl.disable()">
                                  <div>Desativar</div>
                                </li>
                                <li ng-click="categoriasCtrl.rmv($index)">
                                  <div>Excluir</div>
                                </li>
                              </ul>
                            </span>
                          </button>
                        </label>
                      </div>
                      <div class="" ng-if="categoriasCtrl.novaCategoria">
                        <label class="sc-input-group">
                          <input class="sc-input-default sc-input-block" ng-model="categoriasCtrl.newCategoria" type="text">
                          <button class="sc-btn sc-btn-green" ng-click="categoriasCtrl.add()">
                            <i class="sc-icon sc-icon-mais-1"></i>
                          </button>
                          <button class="sc-btn sc-btn-red" ng-click="categoriasCtrl.new()">
                            <i class="sc-icon sc-icon-fechar-1"></i>
                          </button>
                        </label>
                      </div>
                    </div>
                    <div class="sc-m-l-md">
                      <i class="sc-icon sc-icon-mais-1 sc-badge-hover-green" ng-click="perfilCtrl.cadastrarItem(categoria)"></i>
                    </div>
                    <div class="sc-m-l-md">
                      <i class="sc-icon sc-icon-lixeira-2 sc-badge-hover-red" ng-click="perfilCtrl.removerCategoria($index)"></i>
                    </div>
                  </div>

                  <div class="sc-p-xs">
                    <ul>
                      <li class="" ng-if="categoria.itens.length > 0">
                        <div class="flex-row sc-p-v-md sc-label sc-text-blue">
                          <div class="col-xs-3 col-md-1 col-sm-2 sc-text-medium sc-label">Qtde</div>
                          <div class="sc-p-l-md col-xs-auto sc-text-medium sc-label">Item</div>
                        </div>
                      </li>
                      <li ng-repeat="item in categoria.itens" class="sc-p-b-sm">
                        <div class="flex-row">
                          <div class="col-xs-3 col-md-1 col-sm-2">
                            <input class="fcol-md-90 sc-input-default sc-input-thin" ng-value="item.qtd" ng-model="item.qtd" type="number" min="0" max="999" style="max-width: 4.1em;">
                          </div>
                          <div class="sc-p-l-md fcol-xs-auto">
                            <input class="fcol-xs-60 sc-input-default sc-input-thin col-xs-6" type="text" value="{{item.nome}}" ng-model="item.nome">
                          </div>
                          <div class="fcol-xs-1 align-right">
                            <i class="sc-icon sc-icon-lixeira-1 sc-badge-hover-red" ng-click="perfilCtrl.deleteItem(categoria, $index)"></i>
                          </div>
                        </div>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="align-right">
                <button class="sc-btn sc-btn-blue" ng-click="perfilCtrl.salvarPerfil()">Salvar</button>
                <button class="sc-btn sc-btn-red" ng-click="perfil.edit.toggle()">Cancelar</button>
              </div>
            </form>
          </div>
        </li>
      </ul>
    </div>
  </div>

  <div class="sc-modal-footer">
    <button ng-click="perfilCtrl.close()" class="sc-btn">Fechar</button>
  </div>

</div>